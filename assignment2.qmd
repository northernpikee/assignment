---
title: "plot"
format: html
editor: visual
---

```{r}
library(ggplot2)
library(dplyr)

```

The graph shows usage of 4 colors in brands

![](images/clipboard-2838400159.png)

I wanted to do a pie chart but I noticed that the percentages from graph don't add to 100%, probably because one brand can use more than one of given colors, so I made bar chart

```{r}
brand_colors <- data.frame(  # loading data
  color = c("Blue", "Red", "Black", "Yellow")
  percentage = c(33, 29, 28, 13)
) %>%
  mutate(
    label = paste0(color, " (", percentage, "%)"), r #setting labels
  )

```

```{r}

ggplot(brand_colors, aes(x = color, y = percentage, fill = color)) +
  # setting width of bars and placement of labels
  geom_bar(stat = "identity", width = 0.9) + 
  geom_text(aes(label = label), vjust = -0.5, size = 4, color = "black")  +
  
  # setting colors of bars
  
  scale_fill_manual(values = c("Blue" = "#0067A5", "Red" = "#F04923", 
                               "Black" = "#000000", "Yellow" = "#FFBF00"))+
  
  # title
  labs(
     title = "Most-Used Colors in Top Brands (2024)",
  )+

  # additional settings about color of background and margins
  theme(legend.position = "none",
    plot.background = element_rect(fill = "white", color = "white", linewidth = 1),
    panel.background = element_rect(fill = "white"),
    panel.grid = element_blank(),
    axis.line.x = element_line(color = "gray"),
  axis.line.y = element_line(color = "gray"),
    plot.margin = margin(t = 40, r = 20, b = 20, l = 20, unit = "pt"),
    plot.title = element_text(margin = margin(b = 20))
    )+
  # I expanded the size of chart so the label fits above the bar
  expand_limits(y = max(brand_colors$percentage) * 1.2)


```

```{r}
number_of_colors  <- data.frame(  # loading data
  value = c("one or two colors", "more than two colors"),
  percentage = c(95,5)
) %>%
  mutate(
    label = paste0(value, " (", percentage, "%)") #setting labels
  )
```

The second chart is about number of colors that brands use.

```{r}
ggplot(number_of_colors, aes(x = 2, y = percentage, fill = value)) +
  geom_col(width = 1, color = "white") +
  coord_polar("y", start = 0) + # coords are polar because chart is a circle
  geom_text(aes(label = paste0(percentage, "%")), 
            position = position_stack(vjust = 0.5),
            color = "white", size = 5, fontface = "bold") +
  scale_fill_manual(values = c("#FFB121", "#4F78AA")) +
  xlim(0.7, 2.5) +  # creating a donut chart
  labs(title = "Number of colors used by brands") +
  theme_void() + # theme_void to reduce numbers of elements to adjust
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    legend.position = "right",
    legend.title = element_blank() 
  )
```
